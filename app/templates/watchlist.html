{% extends "base.html" %}

{% block title %}Watchlist â€” StockPulse{% endblock %}

{% block content %}
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:var(--space-lg);">
  <h2 class="page-title" style="margin-bottom:0;">Watchlists</h2>
  <div style="display:flex; gap:8px; align-items:center;">
    <span style="font-size:12px;" class="text-muted">Last refreshed: N/A</span>
    <button class="btn btn-sm" data-action="refresh">Refresh</button>
  </div>
</div>

<!-- Watchlist Tabs -->
<div class="sp-tabs">
  {% for wl in watchlists %}
  <a href="/watchlist?watchlist_id={{ wl.id }}"
     class="sp-tab {{ 'active' if wl.id == active_watchlist.id }}">
    {{ wl.name }} ({{ wl.items | length }})
  </a>
  {% endfor %}
  <div x-data="{ open: false }" style="display:flex; align-items:center;">
    <button class="sp-tab" style="color:var(--blue);" @click="open = !open">+ New List</button>
    <form x-show="open" action="/api/watchlists" method="post" style="display:flex; gap:4px; padding:4px 8px;">
      <input class="sp-input" name="name" placeholder="List name" required style="width:120px; padding:4px 8px; font-size:12px;">
      <button type="submit" class="btn btn-primary btn-sm">Create</button>
    </form>
  </div>
</div>

<!-- Add Ticker -->
<form hx-post="/api/watchlist-items"
      hx-target="#watchlist-table"
      hx-swap="innerHTML"
      style="display:flex; gap:8px; margin-bottom:var(--space-lg);">
  <input type="hidden" name="watchlist_id" value="{{ active_watchlist.id }}">
  <input class="sp-input" name="ticker" placeholder="Add ticker (e.g., TSLA)" style="max-width:250px;" required>
  <button type="submit" class="btn btn-primary btn-sm">+ Add</button>
</form>

<!-- Watchlist Table -->
<div id="watchlist-table">
  {% include "partials/watchlist_table.html" %}
</div>
{% endblock %}
